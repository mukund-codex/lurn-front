(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"6Br6":function(e,t,n){"use strict";var r=n("HDdC"),a=n("VRyK");r.a.merge=a.a},"82/m":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("G5QB"),a=n("fXoL"),o=n("tk/3"),i=n("ZtWP"),s=n("hHWK");let c=(()=>{class e extends r.a{constructor(e,t,n){super("section",e),this.http=e,this.companyService=t,this.campaignService=n}setSectionId(e){this.section_id=e}getSectionId(){return this.section_id}setCourseId(e){this.course_id=e}getCourseId(){return this.course_id}getCampaigns(e){return this.campaignService.getAll({company_id:e})}getTypesFromCampaign(e){return this.http.get(`${this.apiUrl}campaign/geography_from_campaign?campaign_id=`+e)}getSectionData(e,t){return this.http.get(`${this.apiUrl}section/section_dropdown_list?campaign_id=`+t+"&course_id="+e)}}return e.\u0275fac=function(t){return new(t||e)(a["\u0275\u0275inject"](o.b),a["\u0275\u0275inject"](i.a),a["\u0275\u0275inject"](s.a))},e.\u0275prov=a["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},J4zT:function(e,t,n){"use strict";n.r(t),n.d(t,"GroupModule",(function(){return re}));var r=n("ofXK"),a=n("1kSV"),o=n("tyNb"),i=n("uu/O"),s=n("zE9r"),c=n("lJxs"),l=n("bOdf"),d=n("Kj3r"),p=n("/uUt"),m=n("eIep"),u=(n("6Br6"),n("fXoL")),g=n("m86e"),h=n("hHWK"),f=n("5eHb"),b=n("5Lta"),v=n("utbL"),x=n("QJFE"),S=n("3Pt+");const C=["searchForm"];function E(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"p"),u["\u0275\u0275text"](1),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](e.message.text)}}function _(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",22),u["\u0275\u0275elementStart"](1,"b",23),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"]("Total Records : ",null==e.groupData.meta||null==e.groupData.meta.pagination?null:e.groupData.meta.pagination.total,"")}}function y(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"tr"),u["\u0275\u0275elementStart"](1,"td"),u["\u0275\u0275text"](2,"No Records Found!"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](1),u["\u0275\u0275attribute"]("colSpan",4))}function w(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"a",29),u["\u0275\u0275listener"]("confirm",(function(){u["\u0275\u0275restoreView"](e);const t=u["\u0275\u0275nextContext"]().$implicit;return u["\u0275\u0275nextContext"](2).delete(t.id)})),u["\u0275\u0275element"](1,"i",30),u["\u0275\u0275elementEnd"]()}if(2&e){u["\u0275\u0275nextContext"](3);const e=u["\u0275\u0275reference"](11);u["\u0275\u0275property"]("swal",e)}}const I=function(e){return[e]},O=function(e){return{campaign_id:e}};function k(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"tr"),u["\u0275\u0275elementStart"](1,"td"),u["\u0275\u0275elementStart"](2,"a",25),u["\u0275\u0275element"](3,"i",26),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](4,w,2,1,"a",27),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"th",28),u["\u0275\u0275text"](6),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"td"),u["\u0275\u0275text"](8),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=t.index,r=u["\u0275\u0275nextContext"]().ngIf,a=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction1"](5,I,"/group/edit/"+e.id))("queryParams",u["\u0275\u0275pureFunction1"](7,O,a.campaign_id)),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",a.showDelete),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate"]((r.meta.pagination.current_page-1)*r.meta.pagination.per_page+n+1),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate"](e.name)}}function F(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275template"](1,y,3,1,"tr",12),u["\u0275\u0275template"](2,k,9,9,"tr",24),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.ngIf;u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",!e.data.length),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngForOf",e.data)}}function P(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"ngb-pagination",31),u["\u0275\u0275listener"]("pageChange",(function(t){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().pageChange(t)}))("pageChange",(function(n){return u["\u0275\u0275restoreView"](e),t.ngIf.meta.pagination.current_page=n})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.ngIf;u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("maxSize",3)("rotate",!0)("collectionSize",e.meta.pagination.total)("pageSize",e.meta.pagination.per_page)("page",e.meta.pagination.current_page)}}function j(e,t){1&e&&u["\u0275\u0275text"](0,"Loading Data...")}let M=(()=>{class e{constructor(e,t,n,r,a){this.activeRoute=e,this.router=t,this.groupService=n,this.cs=r,this.toasterService=a,this.isCollapsed=!0,this.searchObj={},this.parameters={},this.uploadFields=[],this.uploadedFile=[],this.errors=[],this.showExport=!1,this.showDelete=!1}ngOnInit_(){this.activeRoute.params.subscribe(e=>{const t=Object.assign(this.searchObj,e);this.groupData=this.groupService.getAll(t),this.parameters=e})}getCurrentCampaign(){return this.cs.getCampaignId()}ngOnInit(){this.campaign_id=this.getCurrentCampaign(),this.title=this.activeRoute.snapshot.data.title,this.campaign_id&&(this.parameters.campaign_id=this.campaign_id);const e=this.groupService.checkPermissionExist(["export-group","remove-company"]);this.showExport=e[0],this.showDelete=e[1]}ngAfterViewInit(){this.subscription=s.a.merge(this.activeRoute.queryParams.pipe(Object(c.a)(e=>(this.parameters=i.a.merge({},this.parameters,e),this.parameters)),Object(l.a)(e=>this.loadData(e))),this.search()).subscribe(e=>{this.groupData=e,this.uploadFields=e.fields})}fileChange(e){this.uploadedFile=e}closePopup(e){this.toasterService.success(e.data.count+" Records Uploaded Successfully!","Success!",{positionClass:"toast-top-right"}),this.sf.form.updateValueAndValidity()}upload(e){const t=new FormData;t.set("upload_file",e,e.name),this.groupService.upload(t).subscribe(e=>this.closePopup(e),e=>this.controlError(e))}controlError(e){if(400===e.status){for(const t of Object.keys(e.error.error))this.errors.push(e.error.error[t]);alert(e.error.error.upload_file)}}add(){this.router.navigate(["group/add"])}pageChange(e){this.router.navigate([],{relativeTo:this.activeRoute,queryParams:{page:e,campaign_id:this.campaign_id},queryParamsHandling:"merge"})}edit(e){this.router.navigate(["group/edit/"+e])}delete(e){const t=new FormData;this.groupService.delete(t,e).subscribe(e=>{this.toasterService.success("Record Deleted!","Success!",{positionClass:"toast-top-right"}),this.sf.form.updateValueAndValidity()},e=>{this.handleError(e)})}handleError(e){400===e.status?this.toasterService.error(e.error.message,"Error!",{positionClass:"toast-top-right"}):alert("Problems while deleting records!")}export(){this.searchObj.campaign_id=this.getCurrentCampaign();const e=this.groupService.getCurrentDate();this.groupService.exportData(this.searchObj,"Group-"+e)}loadData(e){return this.campaign_id&&(e.campaign_id=this.campaign_id),this.groupService.getAll(e)}search(){return this.sf.valueChanges.pipe(Object(d.a)(400),Object(p.a)(),Object(c.a)(e=>(this.searchObj=i.a.removeNullKeys(e),this.parameters=i.a.merge({},this.parameters,this.searchObj),this.parameters)),Object(m.a)(e=>this.loadData(e)))}changeCampaign(e){this.cs.setCampaignId(e.id),this.campaign_id=this.getCurrentCampaign(),this.parameters.campaign_id=this.campaign_id,this.router.navigate(["group"],{queryParams:{campaign_id:e.id}}),this.sf.form.updateValueAndValidity()}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](o.a),u["\u0275\u0275directiveInject"](o.c),u["\u0275\u0275directiveInject"](g.a),u["\u0275\u0275directiveInject"](h.a),u["\u0275\u0275directiveInject"](f.b))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["app-group"]],viewQuery:function(e,t){var n;1&e&&u["\u0275\u0275viewQuery"](C,!0),2&e&&u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.sf=n.first)},decls:38,vars:11,consts:[[2,"min-height","calc(100vh - 75px)"],[3,"changeCampaign"],["id","simple-table"],[1,"row"],[1,"col-sm-12"],[1,"card","card-border-shadow-0"],[1,"card-header","m-top-bottom-10"],[1,"card-title","module-title"],[3,"addRedirect","showExport","uploadFields","download","uploadFile","uploaded"],["title","Are you sure ?","text","This cannot be undone","icon","question",3,"showCancelButton","focusCancel"],["deleteSwal",""],[1,"card-body"],[4,"ngIf"],[1,"card-block"],["style","float:right;",4,"ngIf"],[1,"table-responsive"],["name","searchForm",1,"table-responsive"],["searchForm","ngForm"],[1,"table","table-bordered","table-condensed","table-striped"],["type","text","name","name","placeholder","Search By Group",1,"form-control",3,"ngModel","keyup","ngModelChange"],[4,"ngIf","ngIfElse"],["loading",""],[2,"float","right"],[1,"tot-record"],[4,"ngFor","ngForOf"],[1,"ng2-smart-action","ng2-smart-action-edit-edit",3,"routerLink","queryParams"],[1,"ft-edit-2","info","font-medium-1","mr-2"],["class","ng2-smart-action ng2-smart-action-delete-delete",3,"swal","confirm",4,"ngIf"],["scope","row"],[1,"ng2-smart-action","ng2-smart-action-delete-delete",3,"swal","confirm"],[1,"ft-x","danger","font-medium-1","mr-2"],[3,"maxSize","rotate","collectionSize","pageSize","page","pageChange"]],template:function(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275elementStart"](1,"app-topbar",1),u["\u0275\u0275listener"]("changeCampaign",(function(e){return t.changeCampaign(e)})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](2,"section",2),u["\u0275\u0275elementStart"](3,"div",3),u["\u0275\u0275elementStart"](4,"div",4),u["\u0275\u0275elementStart"](5,"div",5),u["\u0275\u0275elementStart"](6,"div",6),u["\u0275\u0275elementStart"](7,"h4",7),u["\u0275\u0275text"](8,"Group"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](9,"app-actionbtns",8),u["\u0275\u0275listener"]("download",(function(){return t.export()}))("uploadFile",(function(e){return t.upload(e)}))("uploaded",(function(e){return t.fileChange(e)})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](10,"swal",9,10),u["\u0275\u0275elementStart"](12,"div",11),u["\u0275\u0275template"](13,E,2,1,"p",12),u["\u0275\u0275elementStart"](14,"div",13),u["\u0275\u0275template"](15,_,3,1,"div",14),u["\u0275\u0275elementStart"](16,"div",15),u["\u0275\u0275elementStart"](17,"form",16,17),u["\u0275\u0275elementStart"](19,"table",18),u["\u0275\u0275elementStart"](20,"thead"),u["\u0275\u0275elementStart"](21,"tr"),u["\u0275\u0275elementStart"](22,"th"),u["\u0275\u0275text"](23,"Action"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](24,"th"),u["\u0275\u0275text"](25,"Sr. No"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](26,"th"),u["\u0275\u0275text"](27,"Group Name"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](28,"tbody"),u["\u0275\u0275elementStart"](29,"tr"),u["\u0275\u0275element"](30,"td"),u["\u0275\u0275element"](31,"td"),u["\u0275\u0275elementStart"](32,"td"),u["\u0275\u0275elementStart"](33,"input",19),u["\u0275\u0275listener"]("keyup",(function(){return t.search()}))("ngModelChange",(function(e){return t.group_name=e})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](34,F,3,2,"ng-container",20),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](35,P,2,5,"div",12),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](36,j,1,0,"ng-template",null,21,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275reference"](37);u["\u0275\u0275advance"](9),u["\u0275\u0275property"]("addRedirect","/group/add")("showExport",t.showExport)("uploadFields",t.uploadFields),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("showCancelButton",!0)("focusCancel",!0),u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",t.message),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",t.groupData),u["\u0275\u0275advance"](18),u["\u0275\u0275property"]("ngModel",t.group_name),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.groupData)("ngIfElse",e),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.groupData)}},directives:[b.a,v.a,x.a,r.n,S.D,S.r,S.s,S.b,S.q,S.t,r.m,o.f,x.b,a.l],styles:[""]}),e})();var D=n("0ceX"),A=n("WddB"),V=n("tZre"),R=n("TnO9");function G(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"Group Name is required!"),u["\u0275\u0275elementEnd"]())}function q(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"Group must be atleast 3 characters!"),u["\u0275\u0275elementEnd"]())}function N(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"Please enter a valid Group Name!"),u["\u0275\u0275elementEnd"]())}function U(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275text"](1,"Group can have maximum 50 characters!"),u["\u0275\u0275elementEnd"]())}function L(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",32),u["\u0275\u0275template"](1,G,2,0,"div",21),u["\u0275\u0275template"](2,q,2,0,"div",21),u["\u0275\u0275template"](3,N,2,0,"div",21),u["\u0275\u0275template"](4,U,2,0,"div",21),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.formObj.group_name.errors.required),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.formObj.group_name.errors.minlength),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.formObj.group_name.errors.pattern),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.formObj.group_name.errors.maxlength)}}function B(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275element"](1,"input",33),u["\u0275\u0275elementEnd"]())}function z(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",32),u["\u0275\u0275text"](1),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"](" ",e.error_messages.name," ")}}function $(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",42),u["\u0275\u0275elementStart"](1,"input",43),u["\u0275\u0275listener"]("change",(function(n){u["\u0275\u0275restoreView"](e);const r=t.$implicit,a=u["\u0275\u0275nextContext"]().$implicit;return u["\u0275\u0275nextContext"](3).onChange(r.user_id,n.target.checked,a)})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](2,"label",44),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;u["\u0275\u0275advance"](1),u["\u0275\u0275propertyInterpolate"]("id",e.user_id),u["\u0275\u0275propertyInterpolate"]("value",e.user_id),u["\u0275\u0275property"]("formControlName",e.user_id),u["\u0275\u0275advance"](1),u["\u0275\u0275propertyInterpolate"]("for",e.user_id),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](e.name)}}function K(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"tr",37),u["\u0275\u0275elementStart"](1,"td"),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](3,"td"),u["\u0275\u0275elementStart"](4,"div",15),u["\u0275\u0275elementStart"](5,"div",38),u["\u0275\u0275elementStart"](6,"input",39),u["\u0275\u0275listener"]("change",(function(n){u["\u0275\u0275restoreView"](e);const r=t.$implicit;return u["\u0275\u0275nextContext"](3).checkAll(r,n.target.checked)})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"label",40),u["\u0275\u0275text"](8,"Select All"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](9,$,4,5,"div",41),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,r=u["\u0275\u0275nextContext"](3);u["\u0275\u0275property"]("formGroup",r.group[e]),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate1"](" ",e," "),u["\u0275\u0275advance"](4),u["\u0275\u0275propertyInterpolate"]("id",n),u["\u0275\u0275advance"](1),u["\u0275\u0275propertyInterpolate"]("for",n),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngForOf",r.usersData[e])}}function T(e,t){if(1&e&&(u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275elementStart"](1,"table",34),u["\u0275\u0275elementStart"](2,"thead"),u["\u0275\u0275elementStart"](3,"tr"),u["\u0275\u0275elementStart"](4,"th"),u["\u0275\u0275text"](5,"Role"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](6,"th"),u["\u0275\u0275text"](7,"Add To Group"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](8,"tbody",35),u["\u0275\u0275template"](9,K,10,5,"tr",36),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementContainerEnd"]()),2&e){const e=u["\u0275\u0275nextContext"](2);u["\u0275\u0275advance"](9),u["\u0275\u0275property"]("ngForOf",e.designations)}}const Q=function(e){return{"is-invalid":e}},H=function(){return["/group"]},X=function(e){return{campaign_id:e}};function J(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementContainerStart"](0),u["\u0275\u0275elementStart"](1,"form",10),u["\u0275\u0275listener"]("ngSubmit",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().onSubmit()})),u["\u0275\u0275elementStart"](2,"div",11),u["\u0275\u0275elementStart"](3,"h4",12),u["\u0275\u0275element"](4,"i",13),u["\u0275\u0275text"](5),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](6,"div",14),u["\u0275\u0275elementStart"](7,"div",15),u["\u0275\u0275elementStart"](8,"label",16),u["\u0275\u0275text"](9," Group Name "),u["\u0275\u0275elementStart"](10,"span",17),u["\u0275\u0275text"](11,"*"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](12,"div",18),u["\u0275\u0275element"](13,"input",19),u["\u0275\u0275template"](14,L,5,4,"div",20),u["\u0275\u0275template"](15,B,2,0,"div",21),u["\u0275\u0275template"](16,z,2,1,"div",20),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](17,"div",14),u["\u0275\u0275elementStart"](18,"div",15),u["\u0275\u0275elementStart"](19,"label",22),u["\u0275\u0275text"](20,"Is Active ?"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](21,"div",18),u["\u0275\u0275elementStart"](22,"div",23),u["\u0275\u0275element"](23,"ui-switch",24),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](24,"div",14),u["\u0275\u0275elementStart"](25,"div",15),u["\u0275\u0275elementStart"](26,"label",25),u["\u0275\u0275text"](27,"Group Users"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](28,"div",4),u["\u0275\u0275template"](29,T,10,1,"ng-container",8),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](30,"div",26),u["\u0275\u0275element"](31,"div",27),u["\u0275\u0275elementStart"](32,"div",18),u["\u0275\u0275elementStart"](33,"button",28),u["\u0275\u0275element"](34,"i",29),u["\u0275\u0275text"](35," Cancel "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](36,"button",30),u["\u0275\u0275element"](37,"i",31),u["\u0275\u0275text"](38," Save "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"](),t=u["\u0275\u0275reference"](10);u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("formGroup",e.groupForm),u["\u0275\u0275advance"](4),u["\u0275\u0275textInterpolate1"](" ",e.title," "),u["\u0275\u0275advance"](8),u["\u0275\u0275property"]("ngClass",u["\u0275\u0275pureFunction1"](10,Q,e.submitted&&e.formObj.group_name.errors)),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.submitted&&e.formObj.group_name.errors),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",1==e.editFlag),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",e.error_messages.name),u["\u0275\u0275advance"](13),u["\u0275\u0275property"]("ngIf",e.usersData)("ngIfElse",t),u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("routerLink",u["\u0275\u0275pureFunction0"](12,H))("queryParams",u["\u0275\u0275pureFunction1"](13,X,e.campaign_id))}}function W(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"p"),u["\u0275\u0275text"](1,"Loading Data..."),u["\u0275\u0275elementEnd"]())}let Z=(()=>{class e{constructor(e,t,n,r,a,o,i,s,c){this.groupService=e,this.rolesService=t,this.designationService=n,this.activeRoute=r,this.router=a,this.msgservice=o,this.fb=i,this.cs=s,this.toasterService=c,this.formData=new FormData,this.roles=[],this.designations=[],this.group=[],this.errors=[],this.editFlag=!1,this.submitted=!1,this.error_messages=[]}ngOnInit(){this.campaign_id=this.cs.getCampaignId(),this.title=this.activeRoute.snapshot.data.title,this.dropdownSettingsCompany=i.a.dropDownSettings(!0),this.activeRoute.params.subscribe(e=>{this.buildForm=!1,e.id?(this.group_id=e.id,this.groupData=this.groupService.getAll({id:e.id}).subscribe(e=>{e.data.length&&(this.getcampaign(e.data[0].campaign.company),this.groupForm=this.create_form(e.data[0]),this.getCampUsers(e.data[0].campaign.id,e.data[0].user),this.buildForm=!0)})):(this.getCampUsers(this.campaign_id),this.groupForm=this.create_form(),this.buildForm=!0)}),this.dropdownSettings=i.a.dropDownSettings(!0),this.companies=this.groupService.getCompanies()}create_form(e){return this.fb.group({group_name:[e?e.name:"",[S.B.required,S.B.minLength(3),S.B.maxLength(50),S.B.pattern("^([a-zA-Z0-9 _-])+$")]],user_id:this.fb.array([]),users_checked:this.fb.array([]),is_active:[e?String(e.is_active):"true",[S.B.required]],group_id:[e?e.id:""]})}get formObj(){return this.groupForm.controls}getcampaign(e){"object"==typeof e&&(e=e.id),e&&(this.campaignData=this.groupService.getCampaignFromCompany(e))}getCampUsers(e,t){const n=this;e&&this.groupService.getUsersFromCampaign(e).subscribe(e=>{const r=[],a=[];let o={};const i=[];t&&t.forEach((function(e){i.push(e.id)})),e.data.forEach((function(e){let t=e.designation;new S.f(!1);let s=!1;const c=n.groupForm.controls.users_checked;i&&i.indexOf(e.user_id)>-1&&(c.push(new S.f(e.user_id)),s=!0),void 0===r[t]?(o[t]=new S.i({[e.user_id]:new S.f(s)}),o[t].addControl([t],new S.f(!1)),r[t]=[],a.push(t)):o[t].addControl([e.user_id],new S.f(s)),n.groupForm.controls.user_id.push(o[t]),r[t].push(e)})),this.usersData=r,this.designations=a,this.group=o})}onChange(e,t,n){const r=this.groupForm.controls.users_checked;if(t)r.push(new S.f(e));else{let t=r.controls.findIndex(t=>t.value===e);r.removeAt(t)}}checkAll(e,t){const n=this.groupForm.controls.users_checked,r=this.group[e].controls,a=this;Object.keys(r).forEach((function(e){if(r[e].setValue(t),-1===a.designations.indexOf(e)&&-1===n.controls.findIndex(t=>t.value===e))if(t)n.push(new S.f(e));else{let t=n.controls.findIndex(t=>t.value===e);n.removeAt(t)}}))}onSubmit(){if(this.submitted=!0,this.groupForm.invalid)return;const e=this.groupForm.value;this.formData.set("name",e.group_name),this.formData.set("campaign_id",this.campaign_id);const t=e.users_checked,n=this;Object.keys(t).map((function(e){t[e]&&n.formData.set("users["+e+"]",t[e])})),this.formData.set("is_active",e.is_active);const r=e.group_id;r?this.groupService.update(this.formData,r).subscribe(e=>this.addUpdate("/group","Records Updated Successfully"),e=>this.controlError(e)):this.groupService.save(this.formData).subscribe(e=>this.addUpdate("/group","Records Added Successfully"),e=>this.controlError(e))}addUpdate(e,t){this.router.navigate([e],{queryParams:{campaign_id:this.campaign_id}}).then(()=>{this.toasterService.success(t,"Success!",{positionClass:"toast-top-right"})})}controlError(e){400===e.status?this.error_messages=e.error.error:alert("Problems while saving data")}changeCampaign(e){this.cs.setCampaignId(e.id)}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](g.a),u["\u0275\u0275directiveInject"](D.a),u["\u0275\u0275directiveInject"](A.a),u["\u0275\u0275directiveInject"](o.a),u["\u0275\u0275directiveInject"](o.c),u["\u0275\u0275directiveInject"](V.a),u["\u0275\u0275directiveInject"](S.e),u["\u0275\u0275directiveInject"](h.a),u["\u0275\u0275directiveInject"](f.b))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["app-form"]],decls:11,vars:2,consts:[[2,"min-height","calc(100vh - 75px)"],[3,"changeCampaign"],["id","basic-form-layouts"],[1,"row","match-height"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"px-3"],[4,"ngIf","ngIfElse"],["norecord",""],[1,"form","form-horizontal",3,"formGroup","ngSubmit"],[1,"form-body"],[1,"form-section"],[1,"ft-user"],[1,"form-group"],[1,"row"],["for","group_name",1,"col-md-3","pt-1"],[2,"color","red"],[1,"col-md-9"],["type","text","formControlName","group_name","maxlength","50",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],[4,"ngIf"],[1,"col-md-3","pt-1"],[1,"input-group"],["defaultBgColor","#ff4d4d","labelOn","Yes","labelOff","No","formControlName","is_active"],["for","campaign_id",1,"col-md-12","pt-1"],[1,"form-actions","center"],[1,"col-md-3"],["type","button",1,"btn","btn-raised","btn-orange","mr-1",3,"routerLink","queryParams"],[1,"ft-x"],["type","submit",1,"btn","btn-raised","btn-primary"],[1,"fa","fa-check-square-o"],[1,"invalid-feedback"],["type","hidden","formControlName","group_id"],[1,"table","table-bordered","table-condensed","table-striped"],["formArrayName","user_id","id","label-h"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup"],[1,"col-md-12","col-xs-12","col-sm-12","p-2"],["type","checkbox",3,"id","change"],[2,"font-weight","bold",3,"for"],["class","col-md-6 col-xs-12 col-sm-12 p-2",4,"ngFor","ngForOf"],[1,"col-md-6","col-xs-12","col-sm-12","p-2"],["type","checkbox",3,"formControlName","id","value","change"],[3,"for"]],template:function(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",0),u["\u0275\u0275elementStart"](1,"app-topbar",1),u["\u0275\u0275listener"]("changeCampaign",(function(e){return t.changeCampaign(e)})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](2,"section",2),u["\u0275\u0275elementStart"](3,"div",3),u["\u0275\u0275elementStart"](4,"div",4),u["\u0275\u0275elementStart"](5,"div",5),u["\u0275\u0275elementStart"](6,"div",6),u["\u0275\u0275elementStart"](7,"div",7),u["\u0275\u0275template"](8,J,39,15,"ng-container",8),u["\u0275\u0275template"](9,W,2,0,"ng-template",null,9,u["\u0275\u0275templateRefExtractor"]),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275reference"](10);u["\u0275\u0275advance"](8),u["\u0275\u0275property"]("ngIf",t.buildForm)("ngIfElse",e)}},directives:[b.a,r.n,S.D,S.r,S.j,S.b,S.q,S.h,S.m,r.l,R.a,o.d,S.d,r.m,S.a],styles:['.geo_checkboxes[_ngcontent-%COMP%]:before{content:"";-webkit-appearance:none;background-color:transparent;border:2px solid #0079bf;box-shadow:0 1px 2px rgba(0,0,0,.05),inset 0 -15px 10px -12px rgba(0,0,0,.05);padding:10px;display:inline-block;position:relative;vertical-align:middle;cursor:pointer;margin-right:5px}.geo_checkboxes[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;top:2px;left:9px;width:6px;height:14px;border:solid #0079bf;border-width:0 2px 2px 0;transform:rotate(45deg)}[type=checkbox][_ngcontent-%COMP%]:checked, [type=checkbox][_ngcontent-%COMP%]:not(:checked){position:absolute;left:-9999px}[type=checkbox][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%], [type=checkbox][_ngcontent-%COMP%]:not(:checked) + label[_ngcontent-%COMP%]{position:relative;padding-left:2.85em;cursor:pointer;padding-top:.2em}[type=checkbox][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before, [type=checkbox][_ngcontent-%COMP%]:not(:checked) + label[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;width:2em;height:2em;border:2px solid #f57c00;background:#fff;border-radius:4px;box-shadow:inset 0 1px 3px rgba(0,0,0,.1)}[type=checkbox][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:after, [type=checkbox][_ngcontent-%COMP%]:not(:checked) + label[_ngcontent-%COMP%]:after{content:"\\2713\\0020";position:absolute;top:.15em;left:.18em;font-size:2em;line-height:.8;color:#f57c00;transition:all .2s;font-family:Lucida Sans Unicode,Arial Unicode MS,Arial}[type=checkbox][_ngcontent-%COMP%]:not(:checked) + label[_ngcontent-%COMP%]:after{opacity:0;transform:scale(0)}[type=checkbox][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:after{opacity:1;transform:scale(1)}[type=checkbox][_ngcontent-%COMP%]:disabled:checked + label[_ngcontent-%COMP%]:before, [type=checkbox][_ngcontent-%COMP%]:disabled:not(:checked) + label[_ngcontent-%COMP%]:before{box-shadow:none;border-color:#bbb;background-color:#ddd}[type=checkbox][_ngcontent-%COMP%]:disabled:checked + label[_ngcontent-%COMP%]:after{color:#999}[type=checkbox][_ngcontent-%COMP%]:disabled + label[_ngcontent-%COMP%]{color:#aaa}[type=checkbox][_ngcontent-%COMP%]:checked:focus + label[_ngcontent-%COMP%]:before, [type=checkbox][_ngcontent-%COMP%]:not(:checked):focus + label[_ngcontent-%COMP%]:before{border:2px solid #f57c00}label[_ngcontent-%COMP%]:hover:before{border:2px solid #ffa000!important}#label-h[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{color:#f57c00}']}),e})();const Y=[{path:"",component:M,data:{title:"Group",permission:"list-group"}},{path:"add",component:Z,data:{title:"Add Group",permission:"create-group"}},{path:"edit/:id",component:Z,data:{title:"Edit Group",permission:"modify-group"}}];let ee=(()=>{class e{}return e.\u0275mod=u["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.g.forChild(Y)],o.g]}),e})();var te=n("Egam"),ne=n("PCNd");let re=(()=>{class e{}return e.\u0275mod=u["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[g.a],imports:[[r.c,ee,a.j,S.l,S.y,te.b.forRoot(),ne.a,a.i,x.c.forRoot()]]}),e})()},utbL:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("fXoL"),a=n("tyNb"),o=n("hHWK"),i=n("82/m"),s=n("IAlr"),c=n("ofXK"),l=n("1kSV"),d=n("3Pt+");const p=["uploadForm"];function m(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"a",13),r["\u0275\u0275listener"]("click",(function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"]().add()})),r["\u0275\u0275element"](1,"i",14),r["\u0275\u0275elementEnd"]()}}function u(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"a",13),r["\u0275\u0275listener"]("click",(function(){return r["\u0275\u0275restoreView"](e),r["\u0275\u0275nextContext"]().initiateExport()})),r["\u0275\u0275element"](1,"i",15),r["\u0275\u0275elementEnd"]()}}function g(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"button",16),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275nextContext"]();return t.isCollapsed=!t.isCollapsed})),r["\u0275\u0275element"](1,"i",17),r["\u0275\u0275elementEnd"]()}if(2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275attribute"]("aria-expanded",!e.isCollapsed)}}let h=(()=>{class e{constructor(e,t,n,a){this.router=e,this.cs=t,this.ss=n,this.courseService=a,this.download=new r.EventEmitter,this.uploaded=new r.EventEmitter,this.uploadFile=new r.EventEmitter,this.files=[],this.isCollapsed=!0,this.section_id="",this.course_id=""}ngOnInit(){this.campainId=this.cs.getCampaignId(),this.section_id=this.ss.getSectionId(),this.course_id=this.courseService.getCourseId()}add(){this.router.navigate([this.addRedirect],{queryParams:{section_id:this.section_id,campaign_id:this.campainId,course_id:this.course_id}})}initiateExport(){this.download.emit("export_data")}upload(){this.uploadFile.emit(this.files),this.isCollapsed=!0}onChange(e){const t=e.srcElement.files;this.uploaded.emit(t[0]),this.files=t[0]}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](a.c),r["\u0275\u0275directiveInject"](o.a),r["\u0275\u0275directiveInject"](i.a),r["\u0275\u0275directiveInject"](s.a))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["app-actionbtns"]],viewQuery:function(e,t){var n;1&e&&r["\u0275\u0275viewQuery"](p,!0),2&e&&r["\u0275\u0275queryRefresh"](n=r["\u0275\u0275loadQuery"]())&&(t.userFrm=n.first)},inputs:{addRedirect:"addRedirect",showAdd:"showAdd",showExport:"showExport",showImport:"showImport",uploadFields:"uploadFields",uploadAction:"uploadAction"},outputs:{download:"download",uploaded:"uploaded",uploadFile:"uploadFile"},decls:20,vars:5,consts:[[2,"float","right","margin-bottom","10px"],["class","btn btn-raised btn-purple m-1",3,"click",4,"ngIf"],["type","button","class","btn btn-raised btn-purple m-1","aria-controls","collapseExample",3,"click",4,"ngIf"],["id","collapseExample",3,"ngbCollapse"],[2,"margin-top","60px","margin-bottom","5px",3,"ngSubmit"],["uploadForm","ngForm"],["id","upcsv",1,"form-group","fupload-main-contianer"],[1,"fupload"],["type","file","name","upload","id","upload",1,"",3,"change"],[1,"fbtn-upload"],["type","submit",1,"btn","btn-raised","btn-purple"],[2,"clear","both"],[1,"text-danger","text-csv"],[1,"btn","btn-raised","btn-purple","m-1",3,"click"],[1,"ft-plus-circle","white","warning","font-medium-1",2,"color","#fff !important"],[1,"ft-download","white","warning","font-medium-1",2,"color","#fff !important"],["type","button","aria-controls","collapseExample",1,"btn","btn-raised","btn-purple","m-1",3,"click"],[1,"ft-upload","white","warning","font-medium-1",2,"color","#fff !important"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div",0),r["\u0275\u0275template"](1,m,2,0,"a",1),r["\u0275\u0275template"](2,u,2,0,"a",1),r["\u0275\u0275template"](3,g,2,1,"button",2),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](4,"div",3),r["\u0275\u0275elementStart"](5,"form",4,5),r["\u0275\u0275listener"]("ngSubmit",(function(){return t.upload()})),r["\u0275\u0275elementStart"](7,"div",6),r["\u0275\u0275elementStart"](8,"b"),r["\u0275\u0275text"](9,"Upload CSV"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275element"](10,"br"),r["\u0275\u0275elementStart"](11,"div",7),r["\u0275\u0275elementStart"](12,"input",8),r["\u0275\u0275listener"]("change",(function(e){return t.onChange(e)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275element"](13,"br"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](14,"div",9),r["\u0275\u0275elementStart"](15,"button",10),r["\u0275\u0275text"](16," Upload "),r["\u0275\u0275elementEnd"](),r["\u0275\u0275element"](17,"div",11),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](18,"span",12),r["\u0275\u0275text"](19),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementEnd"]()),2&e&&(r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",!1!==t.showAdd),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",!1!==t.showExport),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",!1!==t.showImport),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngbCollapse",t.isCollapsed),r["\u0275\u0275advance"](15),r["\u0275\u0275textInterpolate1"]("Csv Format (",t.uploadFields,")"))},directives:[c.n,l.b,d.D,d.r,d.s],styles:[".fupload-main-contianer[_ngcontent-%COMP%]{width:50%;border:2px dotted #ffc107;padding:18px;border-radius:5px;background-color:#fffcf7}.fupload[_ngcontent-%COMP%]{padding-top:5px}.fbtn-upload[_ngcontent-%COMP%], .fupload[_ngcontent-%COMP%]{width:50%;float:left}.text-csv[_ngcontent-%COMP%]{font-size:13px}@media only screen and (max-width:600px){.fupload-main-contianer[_ngcontent-%COMP%]{width:100%!important}.fbtn-upload[_ngcontent-%COMP%], .fupload[_ngcontent-%COMP%]{width:100%}}@media only screen and (max-width:1024px){.fupload-main-contianer[_ngcontent-%COMP%]{width:80%!important}}"]}),e})()},"uu/O":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{static removeNullKeys(e){return Object.keys(e).reduce((t,n)=>{const r=t;return void 0!==e[n]&&(r[n]=e[n]),r},{})}static merge(...e){let t={};return e.forEach(e=>{t=Object.assign(t,e)}),t}static setValueCampaign(e){r.campaign_id=e}getValueCampaign(){return r.campaign_id}static dropDownSettings(e,t,n,r){return{singleSelection:e||!1,idField:n||"id",textField:r||"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:3,allowSearchFilter:!0,closeDropDownOnSelection:t||!0}}}}}]);